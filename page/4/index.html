<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title> </title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="description" content="" />

<meta name="keywords" content="">


<meta property="og:title" content=" ">
<meta property="og:site_name" content=""/>
<meta property="og:url" content="http://b-comm.ru/" />
<meta property="og:locale" content="">


<meta property="og:type" content="website" />



<link href="http://b-comm.ru/index.xml" rel="alternate" type="application/rss+xml" title="" />

<link rel="canonical" href="http://b-comm.ru/" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://b-comm.ru/touch-icon-144-precomposed.png">
<link rel="icon" href="http://b-comm.ru/favicon.png">
<meta name="generator" content="Hugo 0.18.1" />

  <!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->



    <link rel="stylesheet" href="http://b-comm.ru/css/bootswatch/default/bootstrap.min.css">


<link rel="stylesheet" href="http://b-comm.ru/css/font-awesome.min.css">
<link rel="stylesheet" href="http://b-comm.ru/css/style.css">


  <link rel="stylesheet" href="http://b-comm.ru/css/highlight/default.css">


</head>
<body data-ng-app="myapp" data-ng-controller="MyController" data-ng-mouseleave="MouseLeave($event)">
    <header id="main-header">
  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        
          
          <a class="navbar-brand-img" href="http://b-comm.ru/">
            <img alt="" src="">
            
          </a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-right">
            
            
          </ul>
        </div>
        
      </div>
    </nav>
  </header>


  <div class="container">
    
    <div class="row">
      <div class="col-sm-12">
        
        
          <div class="row">
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
    <div>
  <h2><a href="http://b-comm.ru/billing/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82-%D0%B4%D0%BB%D1%8F-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B0-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0-mpd5-up-script-%D0%B4%D0%BB%D1%8F-%D0%B8%D0%BD%D1%84">Скрипт для сервера доступа mpd5: up-script для информирования абонентов</a>
</h2>

  <div class="margin-10">
    <small>
  <i class="fa fa-calendar"></i>
  <time datetime="2010-11-28">28 Nov, 2010</time>
</small>

    
  <i class="fa fa-tags"></i>
  
  <a href="http://b-comm.ru/tags/freebsd" class="label label-primary">freebsd</a>
  
  <a href="http://b-comm.ru/tags/ipfw" class="label label-primary">ipfw</a>
  
  <a href="http://b-comm.ru/tags/mpd5" class="label label-primary">mpd5</a>
  
  <a href="http://b-comm.ru/tags/nginx" class="label label-primary">nginx</a>
  
  <a href="http://b-comm.ru/tags/php" class="label label-primary">php</a>
  
  <a href="http://b-comm.ru/tags/up-script" class="label label-primary">up-script</a>
  


  </div>
</div>

    <p>
  
  
    <p>Скрипт для сервера доступа mpd5: up-script для информирования абонентов.</p>

<p>Этот скрипт Мне понадобился при переводе людей с PPPtP на PPPoE. Дело в том, что обзванивать ВСЕХ не всегда лучшая идея, а вот уведомить людей можно при подключении)))</p>

<p>Скрипт до безобразия простой, Мы добавляем ИП-адрес клиента в таблицу фаервола</p>

<p>/usr/local/etc/mpd5/up_warn.php </p>
  


</p>


    <p class="lead"><a href="http://b-comm.ru/billing/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82-%D0%B4%D0%BB%D1%8F-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B0-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0-mpd5-up-script-%D0%B4%D0%BB%D1%8F-%D0%B8%D0%BD%D1%84" class="btn btn-default">Read more &rarr;</a></p>


  </div>
</div>

        
          <div class="row">
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
    <div>
  <h2><a href="http://b-comm.ru/billing/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82-%D0%B4%D0%BB%D1%8F-%D0%BB%D0%BE%D0%B3%D0%B3%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F-%D0%BC%D0%B0%D0%BA-%D0%B0%D0%B4%D1%80%D0%B5%D1%81%D0%BE%D0%B2-%D0%BF">Скрипт для логгирования мак-адресов пользователей</a>
</h2>

  <div class="margin-10">
    <small>
  <i class="fa fa-calendar"></i>
  <time datetime="2009-12-15">15 Dec, 2009</time>
</small>

    
  <i class="fa fa-tags"></i>
  
  <a href="http://b-comm.ru/tags/arp" class="label label-primary">arp</a>
  
  <a href="http://b-comm.ru/tags/freenibs" class="label label-primary">freeNIBS</a>
  
  <a href="http://b-comm.ru/tags/mac" class="label label-primary">mac</a>
  
  <a href="http://b-comm.ru/tags/mysql" class="label label-primary">mysql</a>
  


  </div>
</div>

    <p>
  
  
    <p>Данный скрипт и его копии на серверах доступа и роутерах стоят, что бы сливать инфу о мак-адресах в базу&#8230;</p>

<p>Эти данные потом используется другими скриптами. Отсюда видно кто куда и зачем )))</p>

<p></p>
  


</p>


    <p class="lead"><a href="http://b-comm.ru/billing/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82-%D0%B4%D0%BB%D1%8F-%D0%BB%D0%BE%D0%B3%D0%B3%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F-%D0%BC%D0%B0%D0%BA-%D0%B0%D0%B4%D1%80%D0%B5%D1%81%D0%BE%D0%B2-%D0%BF" class="btn btn-default">Read more &rarr;</a></p>


  </div>
</div>

        
          <div class="row">
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
    <div>
  <h2><a href="http://b-comm.ru/billing/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82%D1%8B-%D0%B1%D0%B5%D0%BA%D0%B0%D0%BF%D0%B0-%D0%B1%D0%B0%D0%B7-%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85-mysql">Скрипты бекапа баз данных mysql</a>
</h2>

  <div class="margin-10">
    <small>
  <i class="fa fa-calendar"></i>
  <time datetime="2009-11-21">21 Nov, 2009</time>
</small>

    
  <i class="fa fa-tags"></i>
  
  <a href="http://b-comm.ru/tags/backup" class="label label-primary">backup</a>
  
  <a href="http://b-comm.ru/tags/mysql" class="label label-primary">mysql</a>
  
  <a href="http://b-comm.ru/tags/%D0%B1%D0%B0%D0%B7%D0%B0-%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85" class="label label-primary">база данных</a>
  
  <a href="http://b-comm.ru/tags/%D0%B1%D0%B5%D0%BA%D0%B0%D0%BF" class="label label-primary">бекап</a>
  


  </div>
</div>

    <p>
  
  
    <p>В нашей жизни возникает потребность бекапить данные и обычно в самый не подходящий момент эти данные, которые &#171;так сильно нужны&#187; &#8212; отсутствуют.</p>

<p>Скрипт бекапит только заданые базы данных (то есть, если забыли добавить свои базы данных &#8212; сами виноваты((( )</p>

<pre lang="shell" line="1">45      20      */2     *       *       root    /bin/mysql_back.sh >/dev/null
</pre>

<p>/bin/mysql_back.sh</p>

<p></p>
  


</p>


    <p class="lead"><a href="http://b-comm.ru/billing/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82%D1%8B-%D0%B1%D0%B5%D0%BA%D0%B0%D0%BF%D0%B0-%D0%B1%D0%B0%D0%B7-%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85-mysql" class="btn btn-default">Read more &rarr;</a></p>


  </div>
</div>

        
          <div class="row">
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
    <div>
  <h2><a href="http://b-comm.ru/billing/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82-usrlocaletcmpd5link-up-%D0%B4%D0%BB%D1%8F-mpd5-%D1%81%D1%80%D0%B0%D0%B1%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D1%8E%D1%89%D0%B8%D0%B9-%D0%BF%D1%80%D0%B8-%D0%BF%D0%BE">Скрипт /usr/local/etc/mpd5/link-up для mpd5 срабатывающий при подключении</a>
</h2>

  <div class="margin-10">
    <small>
  <i class="fa fa-calendar"></i>
  <time datetime="2009-09-12">12 Sep, 2009</time>
</small>

    
  <i class="fa fa-tags"></i>
  
  <a href="http://b-comm.ru/tags/freenibs" class="label label-primary">freeNIBS</a>
  
  <a href="http://b-comm.ru/tags/ipfw" class="label label-primary">ipfw</a>
  
  <a href="http://b-comm.ru/tags/ipfw-nat" class="label label-primary">ipfw nat</a>
  
  <a href="http://b-comm.ru/tags/link-up" class="label label-primary">link up</a>
  
  <a href="http://b-comm.ru/tags/mpd5" class="label label-primary">mpd5</a>
  
  <a href="http://b-comm.ru/tags/mysql" class="label label-primary">mysql</a>
  
  <a href="http://b-comm.ru/tags/nat" class="label label-primary">nat</a>
  
  <a href="http://b-comm.ru/tags/ng_car" class="label label-primary">ng_car</a>
  
  <a href="http://b-comm.ru/tags/pf" class="label label-primary">pf</a>
  
  <a href="http://b-comm.ru/tags/pfctl" class="label label-primary">pfctl</a>
  
  <a href="http://b-comm.ru/tags/pfnat" class="label label-primary">pfnat</a>
  


  </div>
</div>

    <p>
  
  
    <p>Скрипт /usr/local/etc/mpd5/link-up для mpd5 срабатывающий при подключении.</p>

<p>При подключении:</p>

<p>Первым SELECT&#8217;ом из базы Мы смотрим &#8212; Натить ли пользователя? То есть если emty или 0 пользователей &#8212; не натим.</p>

<p>Вторым SELECT&#8217;ом из базы Мы смотрим &#8212; Надо ли менять скорость пользователя, если надо &#8212; меняем. У меня это сделано на ipfw pipe, но думаю перейти на ng_car:)))</p>

<p>Третим SELECT&#8217;ом из базы Мы &#8212; добавляем запись в базу данных, что пользователь подключился.</p>

<p>С помощью данного скрипта Я решал следующую проблему:</p>

<p>Быстродействие &#8212; на php тормозило. Хотя может и руки из жо)))</p>

<p>Подключается скрипт в /usr/local/etc/mpd5/mpd.conf так вот, в секцию с вашим сервером (pptp/pppoe/etc)</p>
  


</p>


    <p class="lead"><a href="http://b-comm.ru/billing/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82-usrlocaletcmpd5link-up-%D0%B4%D0%BB%D1%8F-mpd5-%D1%81%D1%80%D0%B0%D0%B1%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D1%8E%D1%89%D0%B8%D0%B9-%D0%BF%D1%80%D0%B8-%D0%BF%D0%BE" class="btn btn-default">Read more &rarr;</a></p>


  </div>
</div>

        
          <div class="row">
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
    <div>
  <h2><a href="http://b-comm.ru/billing/%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B5-%D1%84%D0%BE%D1%80%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-ipfw-pipe-%D0%B4%D0%BB%D1%8F-%D0%BF%D1%80">Автоматическое формирование ipfw pipe для правильного link-up</a>
</h2>

  <div class="margin-10">
    <small>
  <i class="fa fa-calendar"></i>
  <time datetime="2009-09-11">11 Sep, 2009</time>
</small>

    

  </div>
</div>

    <p>
  
  
    <p>Что делает этот скрипт?</p>

<p>Допустим у Нас есть сервер и пользователи с фейковыми адресами. Мы используем скрипт <a href="http://isp.pl.ua/?p=13">link-up</a> при подключении пользователя. Юзер отлично подключился, пользуется Интернетом &#8212; отключился. Но у нас некая ошибка или изменение &#8212; Мы другому пользователю выдаём этот же ИП-к. Тогда у Нас могут возникнуть проблемы с тем, что скорость не правильно регулируется.</p>

<p>Этот скрипт раз в х-минут по крону или вашему желанию восстанавливает справедливое положение вещей)))</p>

<p>Можно так же добавить сюда очистку для тех, кто не в онлайне)))</p>

<p>Так же Он создаёт правильные pip&#8217;ы, которых не было &#8212; избавляя Вас от надобности apache&#8217;у давать sudo, как это сделано в freeNIBS.</p>

<p>но будьте осторожны Я встречал сообщения о том, что если выполнять очень быстро (у Меня 2000 раз например) команды ipfw могут быть траблы.</p>

<p></p>
  


</p>


    <p class="lead"><a href="http://b-comm.ru/billing/%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B5-%D1%84%D0%BE%D1%80%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-ipfw-pipe-%D0%B4%D0%BB%D1%8F-%D0%BF%D1%80" class="btn btn-default">Read more &rarr;</a></p>


  </div>
</div>

        
          <div class="row">
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
    <div>
  <h2><a href="http://b-comm.ru/billing/%D0%BE%D1%87%D0%B8%D1%81%D1%82%D0%BA%D0%B0-%D0%B1%D0%B0%D0%B7%D1%8B-%D0%B1%D0%B8%D0%BB%D0%BB%D0%B8%D0%BD%D0%B3%D0%B0-freenibs-%D0%BE%D1%82-%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85-%D1%81%D1%82%D0%B0%D1%80">Очистка базы биллинга freeNIBS от данных старше 3-х месяцев</a>
</h2>

  <div class="margin-10">
    <small>
  <i class="fa fa-calendar"></i>
  <time datetime="2009-07-25">25 Jul, 2009</time>
</small>

    
  <i class="fa fa-tags"></i>
  
  <a href="http://b-comm.ru/tags/clear" class="label label-primary">clear</a>
  
  <a href="http://b-comm.ru/tags/freenibs" class="label label-primary">freeNIBS</a>
  
  <a href="http://b-comm.ru/tags/%D0%BE%D1%87%D0%B8%D1%81%D1%82%D0%BA%D0%B0" class="label label-primary">очистка</a>
  


  </div>
</div>

    <p>
  
  
    <p>Очистка базы биллинга freeNIBS от данных старше 3-х месяцев, хотя можно и больше оставить, можно и меньше.</p>

<p>Дело в том, что база actions разрастается &#8212; выборка медленее, мускулу тяжелее)))</p>

<p>15592000 &#8212; это число в секундах, почти 59 дней)))</p>

<p></p>
  


</p>


    <p class="lead"><a href="http://b-comm.ru/billing/%D0%BE%D1%87%D0%B8%D1%81%D1%82%D0%BA%D0%B0-%D0%B1%D0%B0%D0%B7%D1%8B-%D0%B1%D0%B8%D0%BB%D0%BB%D0%B8%D0%BD%D0%B3%D0%B0-freenibs-%D0%BE%D1%82-%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85-%D1%81%D1%82%D0%B0%D1%80" class="btn btn-default">Read more &rarr;</a></p>


  </div>
</div>

        
          <div class="row">
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
    <div>
  <h2><a href="http://b-comm.ru/billing/freenibs-%D1%81%D0%BD%D1%8F%D1%82%D0%B8%D0%B5-%D0%B0%D0%B1%D0%BE%D0%BD%D0%BF%D0%BB%D0%B0%D1%82%D1%8B-%D0%B7%D0%B0-%D1%81%D1%83%D1%82%D0%BA%D0%B8">FreeNIBS Снятие абонплаты за сутки</a>
</h2>

  <div class="margin-10">
    <small>
  <i class="fa fa-calendar"></i>
  <time datetime="2009-07-23">23 Jul, 2009</time>
</small>

    
  <i class="fa fa-tags"></i>
  
  <a href="http://b-comm.ru/tags/freenibs" class="label label-primary">freeNIBS</a>
  
  <a href="http://b-comm.ru/tags/%D0%B0%D0%B1%D0%BE%D0%BD%D0%BF%D0%BB%D0%B0%D1%82%D0%B0" class="label label-primary">абонплата</a>
  
  <a href="http://b-comm.ru/tags/%D1%81%D0%BD%D1%8F%D1%82%D0%B8%D0%B5" class="label label-primary">снятие</a>
  
  <a href="http://b-comm.ru/tags/%D1%81%D1%83%D1%82%D0%BA%D0%B8" class="label label-primary">сутки</a>
  


  </div>
</div>

    <p>
  
  
    <p>Данный скрипт позволяет снимать абонплату за сутки.</p>

<p>Посмотрим сначала web-морду, которая позволяет посмотреть снятия:</p>

<pre lang="php"><?
//sutki
echo "===============================================\n";
echo date("Y-m-d H:i:s")."\n";
echo "===============================================\n";

$us="freenibs";
$db="freenibs";
$pass="freenibs";
$host="localhost";

$date_today = date("Y-m-d H:i:s");
$prev_month_date_start = mktime (0,0,0,date("m")-1,1,date("Y"));
$prev_month_date_stop = mktime (0,0,0-1,date("m"),1,date("Y"));
$r=mysql_connect($host,$us,$pass);
$query="select users.uid,users.gid,users.user,users.deposit,packets.fixed,packets.fixed_cost,users.blocked from users,packets where users.gid=packets.gid and users.blocked=0 and packets.fixed=2 and packets.fixed_cost > 0 order by ucase(users.user)";
$result=mysql_db_query($db,$query,$r) or die ("Error query");

echo "

<BR />Пользователь |До снятия| Добавлено | Остаток <BR />";
while ($row=mysql_fetch_array($result)) {
$uid=$row["uid"];
$gid=$row["gid"];
$user=$row["user"];

$deposit=$row["deposit"];
$fixed_cost=$row["fixed_cost"];

$query_num="SELECT COUNT(user) FROM actions WHERE user='$user' AND start_time > FROM_UNIXTIME($prev_month_date_start) AND start_time &lt; FROM_UNIXTIME($prev_month_date_stop)";
$result_num=mysql_db_query($db,$query_num,$r) or die ("Error query");
$rez = mysql_fetch_array($result_num);

$uniq=rand();
$id=rand();
$posle=$deposit-$fixed_cost;
echo "<BR />".$user." |$deposit| -$fixed_cost |$posle <BR />";
echo "=====================================\n\n<BR />";
};?></pre>

<p>А теперь собственно сам скрипт под гордым названием <strong>abon_day.php</strong> </p>
  


</p>


    <p class="lead"><a href="http://b-comm.ru/billing/freenibs-%D1%81%D0%BD%D1%8F%D1%82%D0%B8%D0%B5-%D0%B0%D0%B1%D0%BE%D0%BD%D0%BF%D0%BB%D0%B0%D1%82%D1%8B-%D0%B7%D0%B0-%D1%81%D1%83%D1%82%D0%BA%D0%B8" class="btn btn-default">Read more &rarr;</a></p>


  </div>
</div>

        
          <div class="row">
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
    <div>
  <h2><a href="http://b-comm.ru/billing/%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0-%D1%81-%D0%B7%D0%B0%D0%B2%D0%B8%D1%81%D1%88%D0%B8%D0%BC%D0%B8-%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F%D0%BC%D0%B8">Работа с зависшими пользователями</a>
</h2>

  <div class="margin-10">
    <small>
  <i class="fa fa-calendar"></i>
  <time datetime="2009-07-23">23 Jul, 2009</time>
</small>

    
  <i class="fa fa-tags"></i>
  
  <a href="http://b-comm.ru/tags/drop" class="label label-primary">drop</a>
  
  <a href="http://b-comm.ru/tags/freenibs" class="label label-primary">freeNIBS</a>
  
  <a href="http://b-comm.ru/tags/kill" class="label label-primary">kill</a>
  
  <a href="http://b-comm.ru/tags/mpd" class="label label-primary">mpd</a>
  
  <a href="http://b-comm.ru/tags/mpd5" class="label label-primary">mpd5</a>
  
  <a href="http://b-comm.ru/tags/perl" class="label label-primary">perl</a>
  
  <a href="http://b-comm.ru/tags/php" class="label label-primary">php</a>
  
  <a href="http://b-comm.ru/tags/user" class="label label-primary">user</a>
  


  </div>
</div>

    <p>
  
  
    <p>Работа с зависшими пользователями, zapped users)))</p>

<p>В наличии FreeBSD сервер, mpd5/mpd4 сервер доступа.</p>

<p>Давно нарыл скрипт, который киляет зависших пользователей при таймауте сессии в 180сек. Я пытался меньше сделать &#8212; но ничего не получается, нормальные сессии падают(((</p>

<p>freez_user_kill.sh:</p>

<p></p>
  


</p>


    <p class="lead"><a href="http://b-comm.ru/billing/%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0-%D1%81-%D0%B7%D0%B0%D0%B2%D0%B8%D1%81%D1%88%D0%B8%D0%BC%D0%B8-%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F%D0%BC%D0%B8" class="btn btn-default">Read more &rarr;</a></p>


  </div>
</div>

        
          <div class="row">
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
    <div>
  <h2><a href="http://b-comm.ru/billing/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82-%D0%BE%D0%B1%D1%81%D0%BB%D1%83%D0%B6%D0%B8%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F-%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86-%D0%B1%D0%B0%D0%B7%D1%8B-%D0%B4%D0%B0%D0%BD%D0%BD">Скрипт обслуживания таблиц базы данных при запуске</a>
</h2>

  <div class="margin-10">
    <small>
  <i class="fa fa-calendar"></i>
  <time datetime="2009-07-23">23 Jul, 2009</time>
</small>

    
  <i class="fa fa-tags"></i>
  
  <a href="http://b-comm.ru/tags/mysql" class="label label-primary">mysql</a>
  
  <a href="http://b-comm.ru/tags/table" class="label label-primary">table</a>
  
  <a href="http://b-comm.ru/tags/%D0%BE%D0%B1%D1%81%D0%BB%D1%83%D0%B6%D0%B8%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5" class="label label-primary">обслуживание</a>
  


  </div>
</div>

    <p>
  
  
    <p>Скрипт обслуживания таблиц базы данных при запуске компьютера.</p>

<p>Идея состоит в том, что не нужно париться в моменты рестарта сервера, коннектиться к нему и восстанавливать таблицы.</p>

<p>Конечно это случалось редко, но всё же случалось и тогда такой скрипт помогал.</p>

<p>Плюс не сомненно в том, что таблицы чекаются, оптимизируются при старте &#8212; это Мне помогнало в freenibs&#8217;е увеличивать скорость выборки)))</p>

<p>main.cpp:</p>

<p></p>
  


</p>


    <p class="lead"><a href="http://b-comm.ru/billing/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82-%D0%BE%D0%B1%D1%81%D0%BB%D1%83%D0%B6%D0%B8%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F-%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86-%D0%B1%D0%B0%D0%B7%D1%8B-%D0%B4%D0%B0%D0%BD%D0%BD" class="btn btn-default">Read more &rarr;</a></p>


  </div>
</div>

        
          <div class="row">
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
    <div>
  <h2><a href="http://b-comm.ru/billing/%D1%81%D0%BA%D0%BB%D0%B0%D0%B4%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-arp-%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D0%B5%D0%B9-%D0%BC%D0%B0%D0%BA-%D0%B0%D0%B4%D1%80%D0%B5%D1%81%D0%BE%D0%B2-%D1%81">Складирование arp записей мак-адресов с помощью скрипта arpwatch на qt4 &#43; mysql</a>
</h2>

  <div class="margin-10">
    <small>
  <i class="fa fa-calendar"></i>
  <time datetime="2009-07-23">23 Jul, 2009</time>
</small>

    
  <i class="fa fa-tags"></i>
  
  <a href="http://b-comm.ru/tags/arp" class="label label-primary">arp</a>
  
  <a href="http://b-comm.ru/tags/bras" class="label label-primary">BRAS</a>
  
  <a href="http://b-comm.ru/tags/c&#43;&#43;" class="label label-primary">c&#43;&#43;</a>
  
  <a href="http://b-comm.ru/tags/freebsd" class="label label-primary">freebsd</a>
  
  <a href="http://b-comm.ru/tags/freenibs" class="label label-primary">freeNIBS</a>
  
  <a href="http://b-comm.ru/tags/linux" class="label label-primary">linux</a>
  
  <a href="http://b-comm.ru/tags/qt4" class="label label-primary">qt4</a>
  
  <a href="http://b-comm.ru/tags/%D0%B4%D0%BE%D0%B4%D0%B5%D0%BB%D0%B0%D1%82%D1%8C" class="label label-primary">доделать</a>
  


  </div>
</div>

    <p>
  
  
    <p>Дано: биллинг FreeNIBS 1.X <em>(можно что угодно)</em></p>

<p>Идея состояла в том, что у Нас есть активные пользователи, есть их ИП-ки, для Них Мы будем искать какие мак-адреса они имеют в текущий момент.</p>

<p>Дальше Мы эти данные помещаем в базу freeNIBS.</p>

<p>Я специально не добавил DROP IF exist&#8230;</p>

<p>Еще замечу, что переход на `actions` ENGINE=InnoDB плодотворно сказался на производительности и старенького компа под базу+freeNIBS стало вполне хватать.</p>

<p></p>
  


</p>


    <p class="lead"><a href="http://b-comm.ru/billing/%D1%81%D0%BA%D0%BB%D0%B0%D0%B4%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-arp-%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D0%B5%D0%B9-%D0%BC%D0%B0%D0%BA-%D0%B0%D0%B4%D1%80%D0%B5%D1%81%D0%BE%D0%B2-%D1%81" class="btn btn-default">Read more &rarr;</a></p>


  </div>
</div>

        
        
<nav>
  <ul class="pagination">
    


<li >
  <a aria-label="First" href="http://b-comm.ru/">
    <span aria-hidden="true">&laquo;&laquo;</span>
  </a>
</li>

<li >
  <a aria-label="Previous" href="http://b-comm.ru/page/3/">
    <span aria-hidden="true">&laquo;</span>
    </a>
</li>

<li >
  <a href="http://b-comm.ru/">
    1
    </a>
</li>

<li >
  <a href="http://b-comm.ru/page/2/">
    2
    </a>
</li>

<li >
  <a href="http://b-comm.ru/page/3/">
    3
    </a>
</li>

<li  class="active" >
  <a href="http://b-comm.ru/page/4/">
    4
    </a>
</li>

<li >
  <a href="http://b-comm.ru/page/5/">
    5
    </a>
</li>


<li >
  <a aria-label="Next" href="http://b-comm.ru/page/5/">
    <span aria-hidden="true">&raquo;</span>
    </a>
</li>
<li >
  <a aria-label="Last" href="http://b-comm.ru/page/5/">
    <span aria-hidden="true">&raquo;&raquo;</span>
  </a>
</li>


  </ul>
</nav>


      </div>
      
    </div>

  </div>

      
<footer class="footer hidden-print">
  <div class="container">
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
           <div class="pull-left">
  <a class="toplink" href="javascript:" id="return-to-top">back to top</a>
</div>
<div class="pull-right">

</div>

        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 text-center">
              
    
<div class="container footline">
    <small>
</small>
</div>


    


        </div>
    </div>
  </div>
</footer>

    

<script src="http://b-comm.ru/js/jquery.min.js"></script>
<script src="http://b-comm.ru/js/bootstrap.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.9/angular.min.js"></script>
<script src="http://b-comm.ru/js/popover/angular-storage.min.js"></script>



<script src="http://b-comm.ru/js/highlight.pack.js"></script>
<script src="http://b-comm.ru/js/site.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<script>
var ENABLE_POPOVER = ""; 
var EXPIRE_COOKIE = ""; 
var SHOW_MODAL_TIMEOUT = ""; 
var MOUSE_LEAVE = ""; 
var MODAL_SIZE = ""; 
var POST_URL = ""; 
var SIGNUP_HEADER = "";
var HEADER_IMAGE = "";
var IMG_DESCRIPTION = "";
var SIGNUP_TEXT = "";
var INPUT_PLACEHOLDER = "";
var SUBMIT_BUTTON = "";
var SUCCESS_MESSAGE = "";
var ERROR_MESSAGE = "";
var OPTIN = "";
var COOKIE_NAME = "";
</script>
<script src="http://b-comm.ru/js/popover/angular-modal-service.min.js"></script>
<script src="http://b-comm.ru/js/angular-ismobile.min.js"></script>
<script src="http://b-comm.ru/js/popover/popover.min.js"></script>

  </body>
</html>

